# 115ç½‘ç›˜å®˜æ–¹APIæ–‡æ¡£é›†æˆå®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

åŸºäº115ç½‘ç›˜å®˜æ–¹APIæ–‡æ¡£ï¼Œå·²å®Œæˆä»¥ä¸‹åŠŸèƒ½çš„é›†æˆå’Œæ›´æ–°ï¼š

### 1. OAuth2è®¤è¯å®¢æˆ·ç«¯ (`cloud_115_oauth.py`)

#### âœ… å®Œæ•´çš„OAuth2 + PKCEæ¨¡å¼å®ç°

1. **ç”ŸæˆPKCEå‚æ•°**
   - `generate_pkce_params()`: ç”Ÿæˆcode_verifierå’Œcode_challenge
   - ä½¿ç”¨secrets.token_urlsafeç”Ÿæˆå®‰å…¨çš„éšæœºå­—ç¬¦ä¸²
   - ä½¿ç”¨SHA256å“ˆå¸Œå’ŒURLå®‰å…¨çš„Base64ç¼–ç 

2. **è·å–è®¾å¤‡ç å’ŒäºŒç»´ç **
   - `get_device_code()`: è·å–è®¾å¤‡ç å’ŒäºŒç»´ç å†…å®¹
   - API: `POST https://passportapi.115.com/open/authDeviceCode`
   - å‚æ•°: `client_id`, `code_challenge`, `code_challenge_method`
   - è¿”å›: `uid`, `qrcode`, `time`, `sign`

3. **è½®è¯¢äºŒç»´ç çŠ¶æ€**
   - `poll_qr_status()`: è½®è¯¢äºŒç»´ç çŠ¶æ€ï¼ˆé•¿è½®è¯¢æ¥å£ï¼‰
   - API: `GET https://qrcodeapi.115.com/get/status/`
   - å‚æ•°: `uid`, `time`, `sign`
   - è¿”å›: `status` (0:æœªæ‰«ç , 1:æ‰«ç æˆåŠŸç­‰å¾…ç¡®è®¤, 2:ç¡®è®¤ç™»å½•), `state` (1:ç»§ç»­è½®è¯¢, 0:ç»“æŸè½®è¯¢)

4. **è·å–è®¿é—®ä»¤ç‰Œ**
   - `get_access_token()`: ç”¨è®¾å¤‡ç æ¢å–access_token
   - API: `POST https://passportapi.115.com/open/deviceCodeToToken`
   - å‚æ•°: `uid`, `code_verifier`
   - è¿”å›: `access_token`, `refresh_token`, `expires_in`

5. **åˆ·æ–°è®¿é—®ä»¤ç‰Œ**
   - `refresh_access_token()`: åˆ·æ–°è®¿é—®ä»¤ç‰Œ
   - API: `POST https://passportapi.115.com/open/refreshToken`
   - å‚æ•°: `refresh_token`
   - è¿”å›: æ–°çš„`access_token`, `refresh_token`, `expires_in`
   - æ³¨æ„äº‹é¡¹: è¯·å‹¿é¢‘ç¹åˆ·æ–°ï¼Œå¦åˆ™åˆ—å…¥é¢‘æ§
   - è¯´æ˜:
     - `access_token`: æ–°çš„access_tokenï¼ŒåŒæ—¶åˆ·æ–°æœ‰æ•ˆæœŸ
     - `refresh_token`: æ–°çš„refresh_tokenï¼Œæœ‰æ•ˆæœŸä¸å»¶é•¿ä¸æ”¹å˜
     - `expires_in`: access_tokenæœ‰æ•ˆæœŸï¼Œå•ä½ç§’ï¼ˆé»˜è®¤2592000ï¼Œå³30å¤©ï¼‰

6. **å®Œæ•´æˆæƒæµç¨‹**
   - `authorize()`: å®Œæ•´çš„æˆæƒæµç¨‹ï¼ˆè·å–è®¾å¤‡ç  â†’ è½®è¯¢çŠ¶æ€ â†’ è·å–ä»¤ç‰Œï¼‰
   - æ”¯æŒè‡ªå®šä¹‰è½®è¯¢é—´éš”å’Œæœ€å¤§è½®è¯¢æ¬¡æ•°
   - è‡ªåŠ¨å¤„ç†æˆæƒçŠ¶æ€è½¬æ¢

### 2. APIå®¢æˆ·ç«¯æ›´æ–° (`cloud_115_api.py`)

#### âœ… ç»Ÿä¸€ä½¿ç”¨proapi.115.comåŸŸå

æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼ŒåŸºç¡€åŸŸåä¸º`https://proapi.115.com/`ï¼Œå·²æ›´æ–°æ‰€æœ‰APIç«¯ç‚¹ï¼š

1. **APIåŸŸåç»Ÿä¸€**
   - ä»`webapi.115.com`æ”¹ä¸º`proapi.115.com`
   - æ‰€æœ‰APIç«¯ç‚¹ä½¿ç”¨ç»Ÿä¸€çš„åŸºç¡€åŸŸå

2. **APIç«¯ç‚¹æ›´æ–°**
   - `get_file_info`: `/open/folder/get_info` âœ…
   - `list_files`: `/open/ufile/files` âœ…ï¼ˆä½¿ç”¨proapiç«¯ç‚¹ï¼‰
   - `search_files`: `/open/ufile/search` âœ…
   - `create_folder`: `/open/folder/add` âœ…
   - `delete_file`: `/open/ufile/delete` âœ…ï¼ˆä½¿ç”¨proapiç«¯ç‚¹ï¼‰
   - `rename_file`: `/open/ufile/update` âœ…ï¼ˆä½¿ç”¨proapiç«¯ç‚¹ï¼‰
   - `move_file`: `/open/ufile/move` âœ…ï¼ˆä½¿ç”¨proapiç«¯ç‚¹ï¼Œå‚æ•°: file_ids, to_cidï¼‰
   - `copy_file`: `/open/ufile/copy` âœ…ï¼ˆä½¿ç”¨proapiç«¯ç‚¹ï¼Œå‚æ•°: file_id, pidï¼‰

3. **å‚æ•°æ ¼å¼ç»Ÿä¸€**
   - æ–‡ä»¶IDä½¿ç”¨intç±»å‹ï¼ˆ115 APIè¦æ±‚ï¼‰
   - å‚æ•°åç§°ç¬¦åˆ115 APIè§„èŒƒï¼ˆfile_ids, to_cid, pidç­‰ï¼‰
   - å“åº”æ ¼å¼ç»Ÿä¸€å¤„ç†ï¼ˆstateæˆ–code=0è¡¨ç¤ºæˆåŠŸï¼‰

4. **å“åº”æ ¼å¼å¤„ç†**
   - æ”¯æŒ`state=1`æˆ–`code=0`è¡¨ç¤ºæˆåŠŸ
   - ç»Ÿä¸€æ•°æ®æ ¼å¼è½¬æ¢
   - å®Œå–„çš„é”™è¯¯å¤„ç†

## ğŸ¯ APIç«¯ç‚¹å¯¹æ¯”

### å®˜æ–¹æ–‡æ¡£ vs å½“å‰å®ç°

| åŠŸèƒ½ | å®˜æ–¹æ–‡æ¡£ | å½“å‰å®ç° | çŠ¶æ€ |
|------|----------|----------|------|
| åŸºç¡€åŸŸå | `https://proapi.115.com/` | `https://proapi.115.com/` | âœ… å·²ç»Ÿä¸€ |
| è·å–æ–‡ä»¶è¯¦æƒ… | `/open/folder/get_info` | `/open/folder/get_info` | âœ… ä¸€è‡´ |
| è·å–æ–‡ä»¶åˆ—è¡¨ | `/open/ufile/files` | `/open/ufile/files` | âœ… å·²æ›´æ–° |
| æœç´¢æ–‡ä»¶ | `/open/ufile/search` | `/open/ufile/search` | âœ… ä¸€è‡´ |
| æ–°å»ºæ–‡ä»¶å¤¹ | `/open/folder/add` | `/open/folder/add` | âœ… ä¸€è‡´ |
| åˆ é™¤æ–‡ä»¶ | `/open/ufile/delete` | `/open/ufile/delete` | âœ… å·²æ›´æ–° |
| é‡å‘½åæ–‡ä»¶ | `/open/ufile/update` | `/open/ufile/update` | âœ… å·²æ›´æ–° |
| ç§»åŠ¨æ–‡ä»¶ | `/open/ufile/move` | `/open/ufile/move` | âœ… å·²æ›´æ–° |
| å¤åˆ¶æ–‡ä»¶ | `/open/ufile/copy` | `/open/ufile/copy` | âœ… å·²æ›´æ–° |
| è·å–ç”¨æˆ·ä¿¡æ¯ | `/open/user/info` | `/open/user/info` | âœ… å·²å®ç° |
| è·å–ä¸Šä¼ å‡­è¯ | `/open/upload/get_token` | `/open/upload/get_token` | âœ… å·²å®ç° |
| æ–‡ä»¶ä¸Šä¼ åˆå§‹åŒ– | `/open/upload/init` | `/open/upload/init` | âœ… å·²å®ç° |
| æ–­ç‚¹ç»­ä¼  | `/open/upload/resume` | `/open/upload/resume` | âœ… å·²å®ç° |
| è·å–ä¸‹è½½åœ°å€ | `/open/ufile/downurl` | `/open/ufile/downurl` | âœ… å·²å®ç° |
| OAuth2è®¤è¯ | `passportapi.115.com` | `passportapi.115.com` | âœ… å·²å®ç° |
| äºŒç»´ç çŠ¶æ€ | `qrcodeapi.115.com` | `qrcodeapi.115.com` | âœ… å·²å®ç° |

## ğŸ“Š OAuth2è®¤è¯æµç¨‹

### å®Œæ•´æµç¨‹

```
1. ç”ŸæˆPKCEå‚æ•°
   â”œâ”€â”€ code_verifier: 43-128ä½éšæœºå­—ç¬¦ä¸²
   â””â”€â”€ code_challenge: url_safe(base64_encode(sha256(code_verifier)))

2. è·å–è®¾å¤‡ç å’ŒäºŒç»´ç 
   â”œâ”€â”€ API: POST https://passportapi.115.com/open/authDeviceCode
   â”œâ”€â”€ å‚æ•°: client_id, code_challenge, code_challenge_method
   â””â”€â”€ è¿”å›: uid, qrcode, time, sign

3. æ˜¾ç¤ºäºŒç»´ç 
   â””â”€â”€ ç”¨æˆ·ä½¿ç”¨115å®¢æˆ·ç«¯æ‰«ç 

4. è½®è¯¢äºŒç»´ç çŠ¶æ€ï¼ˆé•¿è½®è¯¢ï¼‰
   â”œâ”€â”€ API: GET https://qrcodeapi.115.com/get/status/
   â”œâ”€â”€ å‚æ•°: uid, time, sign
   â”œâ”€â”€ çŠ¶æ€: 0=æœªæ‰«ç , 1=æ‰«ç æˆåŠŸç­‰å¾…ç¡®è®¤, 2=ç¡®è®¤ç™»å½•
   â””â”€â”€ å¾ªç¯ç›´åˆ°çŠ¶æ€ä¸º2æˆ–è¶…æ—¶

5. è·å–è®¿é—®ä»¤ç‰Œ
   â”œâ”€â”€ API: POST https://passportapi.115.com/open/deviceCodeToToken
   â”œâ”€â”€ å‚æ•°: uid, code_verifier
   â””â”€â”€ è¿”å›: access_token, refresh_token, expires_in

6. ä½¿ç”¨è®¿é—®ä»¤ç‰Œ
   â””â”€â”€ åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦: Authorization: Bearer {access_token}
```

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### 1. OAuth2è®¤è¯

```python
from app.core.cloud_storage.providers.cloud_115_oauth import Cloud115OAuth

# åˆå§‹åŒ–OAuthå®¢æˆ·ç«¯
oauth = Cloud115OAuth(client_id="your_app_id")

# æ–¹æ³•1: å®Œæ•´æˆæƒæµç¨‹ï¼ˆæ¨èï¼‰
token_info = await oauth.authorize()
# è¿”å›: {
#     "access_token": "...",
#     "refresh_token": "...",
#     "expires_in": 7200,
#     "token_type": "Bearer"
# }

# æ–¹æ³•2: åˆ†æ­¥æˆæƒ
# Step 1: è·å–è®¾å¤‡ç å’ŒäºŒç»´ç 
device_info = await oauth.get_device_code()
qrcode = device_info.get("qrcode")
qr_url = device_info.get("qr_url")
print(f"è¯·æ‰«ç : {qr_url}")

# Step 2: è½®è¯¢äºŒç»´ç çŠ¶æ€
while True:
    status_info = await oauth.poll_qr_status()
    status = status_info.get("status")
    if status == 2:
        break
    await asyncio.sleep(2)

# Step 3: è·å–è®¿é—®ä»¤ç‰Œ
token_info = await oauth.get_access_token()
```

### 2. ä½¿ç”¨APIå®¢æˆ·ç«¯

```python
from app.core.cloud_storage.providers.cloud_115_api import Cloud115API

# åˆå§‹åŒ–APIå®¢æˆ·ç«¯ï¼ˆä½¿ç”¨proapi.115.comï¼‰
api = Cloud115API(access_token=token_info["access_token"])

# è·å–æ–‡ä»¶åˆ—è¡¨
files = await api.list_files(file_id="0")  # æ ¹ç›®å½•

# åˆ é™¤æ–‡ä»¶
await api.delete_file(file_id="123")

# é‡å‘½åæ–‡ä»¶
await api.rename_file(file_id="123", new_name="æ–°æ–‡ä»¶å.mkv")

# ç§»åŠ¨æ–‡ä»¶
await api.move_file(file_id="123", target_parent_id="456")

# å¤åˆ¶æ–‡ä»¶
await api.copy_file(file_id="123", target_parent_id="456")

# è·å–ç”¨æˆ·ä¿¡æ¯
user_info = await api.get_user_info()
# è¿”å›: {
#     "user_id": "123456",
#     "user_name": "ç”¨æˆ·å",
#     "user_face_s": "å°å¤´åƒURL",
#     "user_face_m": "ä¸­å¤´åƒURL",
#     "user_face_l": "å¤§å¤´åƒURL",
#     "rt_space_info": {
#         "all_total": {"size": 1152921504606846976, "size_format": "1TB"},
#         "all_remain": {"size": 576460752303423488, "size_format": "500GB"},
#         "all_use": {"size": 576460752303423488, "size_format": "500GB"}
#     },
#     "vip_info": {
#         "level_name": "å¹´è´¹VIP",
#         "expire": 1735689600
#     }
# }

# è·å–ç”¨æˆ·ç©ºé—´ä¿¡æ¯ï¼ˆä¾¿æ·æ–¹æ³•ï¼‰
space_info = await api.get_user_space_info()
# è¿”å›: {
#     "all_total": {"size": 1152921504606846976, "size_format": "1TB"},
#     "all_remain": {"size": 576460752303423488, "size_format": "500GB"},
#     "all_use": {"size": 576460752303423488, "size_format": "500GB"}
# }

# è·å–ç”¨æˆ·VIPä¿¡æ¯ï¼ˆä¾¿æ·æ–¹æ³•ï¼‰
vip_info = await api.get_user_vip_info()
# è¿”å›: {
#     "level_name": "å¹´è´¹VIP",
#     "expire": 1735689600
# }
```

### 3. åˆ·æ–°è®¿é—®ä»¤ç‰Œ

```python
# åˆ·æ–°è®¿é—®ä»¤ç‰Œï¼ˆæ³¨æ„ï¼šè¯·å‹¿é¢‘ç¹åˆ·æ–°ï¼Œå¦åˆ™åˆ—å…¥é¢‘æ§ï¼‰
new_token_info = await oauth.refresh_access_token(
    refresh_token=token_info["refresh_token"]
)
# è¿”å›: {
#     "access_token": "æ–°çš„access_token",
#     "refresh_token": "æ–°çš„refresh_tokenï¼ˆæœ‰æ•ˆæœŸä¸å»¶é•¿ä¸æ”¹å˜ï¼‰",
#     "expires_in": 2592000,  # 30å¤©
#     "token_type": "Bearer"
# }

# é‡è¦æç¤ºï¼š
# - access_token: æ–°çš„access_tokenï¼ŒåŒæ—¶åˆ·æ–°æœ‰æ•ˆæœŸ
# - refresh_token: æ–°çš„refresh_tokenï¼Œæœ‰æ•ˆæœŸä¸å»¶é•¿ä¸æ”¹å˜ï¼ˆä»ç„¶æ˜¯1å¹´ï¼‰
# - expires_in: access_tokenæœ‰æ•ˆæœŸï¼Œå•ä½ç§’ï¼ˆé»˜è®¤2592000ï¼Œå³30å¤©ï¼‰
# - è¯·å‹¿é¢‘ç¹åˆ·æ–°ï¼Œå¦åˆ™ä¼šè¢«é¢‘æ§
```

## ğŸ“ APIå‚æ•°è¯´æ˜

### 1. æ–‡ä»¶åˆ—è¡¨API (`/open/ufile/files`)

**å‚æ•°**:
- `cid`: ç›®å½•IDï¼ˆintç±»å‹ï¼‰
- `limit`: å•é¡µè®°å½•æ•°ï¼ˆé»˜è®¤1000ï¼‰
- `offset`: åç§»é‡
- `cur`: æ˜¯å¦åªæ˜¾ç¤ºå½“å‰ç›®å½•ï¼ˆ1:æ˜¯, 0:å¦ï¼‰
- `show_dir`: æ˜¯å¦æ˜¾ç¤ºæ–‡ä»¶å¤¹ï¼ˆ1:æ˜¾ç¤º, 0:ä¸æ˜¾ç¤ºï¼‰

**å“åº”æ ¼å¼**:
```json
{
    "state": 1,
    "data": [
        {
            "fid": "123",
            "fn": "movie.mkv",
            "fc": "1",  // 1:æ–‡ä»¶, 0:æ–‡ä»¶å¤¹
            "fs": "1610612736",
            "sha": "abc123...",
            "pc": "pick123",
            "time": "1234567890",
            "upt": "1234567890",
            "ico": "mkv"
        }
    ]
}
```

### 2. åˆ é™¤æ–‡ä»¶API (`/open/ufile/delete`)

**å‚æ•°**:
- `file_ids`: æ–‡ä»¶IDï¼ˆintç±»å‹ï¼Œå•ä¸ªåˆ é™¤ï¼‰
- æ³¨æ„ï¼š115 APIä½¿ç”¨`file_ids`å‚æ•°ï¼Œå€¼ä¸ºintç±»å‹

### 3. é‡å‘½åæ–‡ä»¶API (`/open/ufile/update`)

**å‚æ•°**:
- `file_id`: æ–‡ä»¶IDï¼ˆintç±»å‹ï¼‰
- `file_name`: æ–°åç§°

### 4. ç§»åŠ¨æ–‡ä»¶API (`/open/ufile/move`)

**å‚æ•°**:
- `file_ids`: æ–‡ä»¶IDï¼ˆintç±»å‹ï¼‰
- `to_cid`: ç›®æ ‡ç›®å½•IDï¼ˆintç±»å‹ï¼‰

### 5. å¤åˆ¶æ–‡ä»¶API (`/open/ufile/copy`)

**å‚æ•°**:
- `file_id`: æ–‡ä»¶IDï¼ˆintç±»å‹ï¼‰
- `pid`: ç›®æ ‡çˆ¶ç›®å½•IDï¼ˆintç±»å‹ï¼‰

## ğŸ” å…³é”®å‘ç°

### 1. APIåŸŸåç¡®è®¤

- **å®˜æ–¹æ–‡æ¡£**: åŸºç¡€åŸŸåä¸º`https://proapi.115.com/`
- **å½“å‰å®ç°**: å·²ç»Ÿä¸€ä½¿ç”¨`proapi.115.com`
- **ç»“è®º**: âœ… åŸŸåæ­£ç¡®

### 2. OAuth2ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸ

- **access_token**: 
  - åˆå§‹æœ‰æ•ˆæœŸ: 7200ç§’ï¼ˆ2å°æ—¶ï¼‰
  - åˆ·æ–°åæœ‰æ•ˆæœŸ: 2592000ç§’ï¼ˆ30å¤©ï¼‰
  - ç”¨é€”: è®¿é—®èµ„æºæ¥å£çš„å‡­è¯
  
- **refresh_token**: 
  - æœ‰æ•ˆæœŸ: 1å¹´ï¼ˆå›ºå®šï¼Œä¸å»¶é•¿ä¸æ”¹å˜ï¼‰
  - ç”¨é€”: åˆ·æ–°access_token
  - åˆ·æ–°å: è¿”å›æ–°çš„refresh_tokenï¼Œä½†æœ‰æ•ˆæœŸä¸å˜
  
- **åˆ·æ–°æ³¨æ„äº‹é¡¹**: 
  - è¯·å‹¿é¢‘ç¹åˆ·æ–°ï¼Œå¦åˆ™åˆ—å…¥é¢‘æ§
  - åˆ·æ–°åä¼šè¿”å›æ–°çš„access_tokenå’Œrefresh_token
  - refresh_tokençš„æœ‰æ•ˆæœŸä¸ä¼šå› ä¸ºåˆ·æ–°è€Œå»¶é•¿

### 2. APIç«¯ç‚¹ç¡®è®¤

- **æ–‡ä»¶åˆ—è¡¨**: `/open/ufile/files`ï¼ˆä¸æ˜¯`/open/folder/list`ï¼‰
- **åˆ é™¤æ–‡ä»¶**: `/open/ufile/delete`ï¼ˆå‚æ•°: `file_ids`ï¼Œintç±»å‹ï¼‰
- **é‡å‘½åæ–‡ä»¶**: `/open/ufile/update`ï¼ˆä¸æ˜¯`/open/file/rename`ï¼‰
- **ç§»åŠ¨æ–‡ä»¶**: `/open/ufile/move`ï¼ˆå‚æ•°: `file_ids`, `to_cid`ï¼‰
- **å¤åˆ¶æ–‡ä»¶**: `/open/ufile/copy`ï¼ˆå‚æ•°: `file_id`, `pid`ï¼‰

### 3. OAuth2è®¤è¯æµç¨‹

- **æ¨¡å¼**: OAuth2 + PKCE
- **é€‚ç”¨åœºæ™¯**: æ— åç«¯æœåŠ¡çš„ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯
- **ç‰¹ç‚¹**: ä¸éœ€è¦AppSecret
- **æµç¨‹**: è®¾å¤‡ç æˆæƒæµç¨‹ï¼ˆDevice Authorization Flowï¼‰

### 4. å“åº”æ ¼å¼

- **æˆåŠŸ**: `state=1`æˆ–`code=0`
- **å¤±è´¥**: `state=0`æˆ–`code!=0`
- **é”™è¯¯ä¿¡æ¯**: `message`å­—æ®µ

## ğŸš§ å¾…å®ç°åŠŸèƒ½

### é«˜ä¼˜å…ˆçº§

1. **æ–‡ä»¶ä¸Šä¼ API**
   - åˆå§‹åŒ–ä¸Šä¼  (`/open/upload/init`)
   - è·å–ä¸Šä¼ å‡­è¯ (`/open/upload/get_token`)
   - æ–­ç‚¹ç»­ä¼  (`/open/upload/resume`)
   - OSSåˆ†ç‰‡ä¸Šä¼ 

2. **æ–‡ä»¶ä¸‹è½½API** âœ… éƒ¨åˆ†å®ç°
   - è·å–ä¸‹è½½é“¾æ¥ (`/open/ufile/downurl`) âœ…
   - æµå¼ä¸‹è½½ï¼ˆå¾…å®ç°ï¼‰
   - æ–­ç‚¹ç»­ä¼ ï¼ˆå¾…å®ç°ï¼‰

3. **ç”¨æˆ·ä¿¡æ¯API** âœ… å·²å®ç°
   - è·å–ç”¨æˆ·ä¿¡æ¯ (`/open/user/info`) âœ…
   - å­˜å‚¨ç©ºé—´æŸ¥è¯¢ âœ…
   - VIPä¿¡æ¯æŸ¥è¯¢ âœ…

4. **æ–‡ä»¶æ“ä½œAPI** âœ… å·²å®ç°
   - æ–‡ä»¶å¤åˆ¶ (`/open/ufile/copy`) âœ…
   - æ–‡ä»¶ç§»åŠ¨ (`/open/ufile/move`) âœ…
   - æ–‡ä»¶æ›´æ–° (`/open/ufile/update`) âœ…
   - æ–‡ä»¶åˆ é™¤ (`/open/ufile/delete`) âœ…
   - è·å–ä¸‹è½½åœ°å€ (`/open/ufile/downurl`) âœ…

### ä¸­ä¼˜å…ˆçº§

4. **APIå“åº”æ ¼å¼ç»Ÿä¸€**
   - ç»Ÿä¸€å¤„ç†`state`å’Œ`code`å­—æ®µ
   - ç»Ÿä¸€æ•°æ®æ ¼å¼è½¬æ¢
   - å®Œå–„é”™è¯¯å¤„ç†

5. **OAuth2è®¤è¯é›†æˆ**
   - é›†æˆåˆ°`Cloud115API`ç±»
   - è‡ªåŠ¨ä»¤ç‰Œåˆ·æ–°
   - ä»¤ç‰ŒæŒä¹…åŒ–

## ğŸ“š å‚è€ƒæ–‡æ¡£

### å®˜æ–¹æ–‡æ¡£

- **115ç½‘ç›˜å¼€æ”¾å¹³å°**: https://www.yuque.com/115yun/open/qur839kyx9cgxpxi
- **åŸºç¡€åŸŸå**: https://proapi.115.com/
- **OAuth2è®¤è¯**: æ‰‹æœºæ‰«ç æˆæƒPKCEæ¨¡å¼

### å…³é”®ä¿¡æ¯

1. **å¼€å‘è€…ç”³è¯·æµç¨‹**:
   - ç­¾ç½²åè®®
   - å¡«å†™å…¥é©»èµ„æ–™
   - å¡«å†™è®¤è¯ä¿¡æ¯
   - æäº¤å…¥é©»ç”³è¯·
   - åˆ›å»ºåº”ç”¨
   - æ¥å£è°ƒè¯•

2. **OAuth2è®¤è¯æµç¨‹**:
   - è·å–è®¾å¤‡ç å’ŒäºŒç»´ç 
   - è½®è¯¢äºŒç»´ç çŠ¶æ€ï¼ˆé•¿è½®è¯¢ï¼‰
   - è·å–è®¿é—®ä»¤ç‰Œ
   - åˆ·æ–°è®¿é—®ä»¤ç‰Œ

3. **APIè°ƒç”¨**:
   - ä½¿ç”¨Bearer tokenè®¤è¯
   - åŸºç¡€åŸŸåä¸º`proapi.115.com`
   - å“åº”æ ¼å¼: `state`æˆ–`code`å­—æ®µè¡¨ç¤ºçŠ¶æ€

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ

1. âœ… OAuth2è®¤è¯å®¢æˆ·ç«¯ï¼ˆå®Œæ•´çš„PKCEæ¨¡å¼å®ç°ï¼‰
2. âœ… APIå®¢æˆ·ç«¯æ›´æ–°ï¼ˆç»Ÿä¸€ä½¿ç”¨proapi.115.comï¼‰
3. âœ… APIç«¯ç‚¹æ›´æ–°ï¼ˆä½¿ç”¨å®˜æ–¹æ–‡æ¡£çš„ç«¯ç‚¹ï¼‰
4. âœ… å‚æ•°æ ¼å¼ç»Ÿä¸€ï¼ˆä½¿ç”¨intç±»å‹å’Œæ­£ç¡®çš„å‚æ•°åï¼‰
5. âœ… å“åº”æ ¼å¼å¤„ç†ï¼ˆæ”¯æŒstateå’Œcodeå­—æ®µï¼‰
6. âœ… ç”¨æˆ·ä¿¡æ¯APIï¼ˆè·å–ç”¨æˆ·ä¿¡æ¯ã€ç©ºé—´ä¿¡æ¯ã€VIPä¿¡æ¯ï¼‰
7. âœ… æ–‡ä»¶ä¸Šä¼ APIï¼ˆè·å–ä¸Šä¼ å‡­è¯ã€ä¸Šä¼ åˆå§‹åŒ–ã€æ–­ç‚¹ç»­ä¼ ï¼‰
8. âœ… æ–‡ä»¶ä¸‹è½½APIï¼ˆè·å–ä¸‹è½½åœ°å€ï¼‰

### å…³é”®æ”¹è¿›

1. **APIåŸŸå**: ä»`webapi.115.com`æ”¹ä¸º`proapi.115.com`ï¼ˆå®˜æ–¹æ¨èï¼‰
2. **APIç«¯ç‚¹**: ä½¿ç”¨å®˜æ–¹æ–‡æ¡£çš„ç«¯ç‚¹ï¼ˆ`/open/ufile/*`ï¼‰
3. **å‚æ•°æ ¼å¼**: ä½¿ç”¨intç±»å‹å’Œæ­£ç¡®çš„å‚æ•°åï¼ˆ`file_ids`, `to_cid`, `pid`ï¼‰
4. **OAuth2è®¤è¯**: å®Œæ•´çš„PKCEæ¨¡å¼å®ç°

### ä¸‹ä¸€æ­¥

1. å®ç°æ–‡ä»¶ä¸Šä¼ API
2. å®ç°æ–‡ä»¶ä¸‹è½½API
3. å®ç°ç”¨æˆ·ä¿¡æ¯API
4. é›†æˆOAuth2è®¤è¯åˆ°APIå®¢æˆ·ç«¯
5. æµ‹è¯•æ‰€æœ‰APIåŠŸèƒ½

**115ç½‘ç›˜å®˜æ–¹APIæ–‡æ¡£å·²æˆåŠŸé›†æˆï¼**

