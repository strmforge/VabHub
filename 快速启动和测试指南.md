# 快速启动和测试指南

## 🚀 快速启动

### 1. 启动后端服务

**方式1: 使用启动脚本（推荐）**
```bash
cd VabHub
python backend/scripts/start.py
```

**方式2: 直接使用uvicorn**
```bash
cd VabHub/backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

**方式3: 使用Python模块**
```bash
cd VabHub/backend
python -m uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 2. 验证服务启动

**检查服务状态**
```bash
python backend/scripts/check_service_status.py
```

**运行简单测试**
```bash
python backend/scripts/test_simple.py
```

**访问API文档**
```
http://localhost:8000/docs
```

---

## 🧪 测试验证

### 1. 基础功能测试

**运行基础测试脚本**
```bash
python backend/scripts/test_backend_basic.py
```

**测试项目**:
- 健康检查
- API文档
- 数据库连接
- Redis连接（如果配置）
- 统一响应格式

### 2. 功能测试

**115网盘功能测试**
```bash
python backend/scripts/test_115_qrcode.py
python backend/scripts/test_115_file_operations.py
```

**订阅管理测试**
- 创建订阅
- 更新订阅
- 删除订阅
- 执行订阅搜索

**下载管理测试**
- 创建下载任务
- 更新下载任务
- 删除下载任务
- 下载状态更新

### 3. 前端测试

**启动前端服务**
```bash
cd frontend
npm install
npm run dev
```

**访问前端应用**
```
http://localhost:5173
```

---

## 🔧 故障排除

### 问题1: 服务无法启动

**检查项**:
1. Python版本（需要Python 3.8+）
2. 依赖包是否安装完整
3. 数据库配置是否正确
4. 端口是否被占用

**解决方法**:
```bash
# 检查Python版本
python --version

# 安装依赖
pip install -r backend/requirements.txt

# 检查端口占用
netstat -ano | findstr ":8000"

# 终止占用端口的进程
taskkill /PID <PID> /F
```

### 问题2: 数据库连接失败

**检查项**:
1. 数据库配置是否正确
2. 数据库服务是否运行（PostgreSQL）
3. 数据库文件是否存在（SQLite）

**解决方法**:
```bash
# 检查数据库配置
python -c "from app.core.config import settings; print(settings.DATABASE_URL)"

# 初始化数据库
python backend/scripts/init_db.py

# 切换到SQLite（开发环境）
# 修改 backend/app/core/config.py
# DATABASE_URL = "sqlite:///./vabhub.db"
```

### 问题3: 服务响应超时

**可能原因**:
1. 服务正在启动中
2. 数据库初始化耗时较长
3. 健康检查执行耗时操作

**解决方法**:
1. 等待更长时间（30秒-1分钟）
2. 检查服务日志
3. 检查数据库连接
4. 简化健康检查

---

## 📋 测试 checklist

### 后端测试
- [ ] 服务启动成功
- [ ] 健康检查通过
- [ ] API文档可访问
- [ ] 数据库连接正常
- [ ] Redis连接正常（如果配置）
- [ ] 统一响应格式正确
- [ ] 错误处理正常

### 前端测试
- [ ] 前端服务启动成功
- [ ] 页面加载正常
- [ ] 登录功能正常
- [ ] API调用正常
- [ ] 错误处理正常
- [ ] 用户体验良好

### 115网盘测试
- [ ] 115网盘配置创建成功
- [ ] 二维码生成成功
- [ ] 登录功能正常
- [ ] 文件列表正常
- [ ] 文件操作正常

---

## 🎯 快速测试命令

### 一键测试
```bash
# 检查服务状态
python backend/scripts/check_service_status.py

# 运行简单测试
python backend/scripts/test_simple.py

# 运行完整测试
python backend/scripts/test_backend_basic.py
```

### 手动测试
```bash
# 测试根端点
curl http://localhost:8000/

# 测试健康检查
curl http://localhost:8000/health

# 测试API文档
curl http://localhost:8000/docs
```

---

## 📝 测试记录

### 测试时间
[填写测试时间]

### 测试环境
- 操作系统: Windows 10
- Python版本: 3.11
- 数据库: SQLite
- 服务端口: 8000

### 测试结果
- [ ] 服务启动: [通过/失败]
- [ ] 健康检查: [通过/失败]
- [ ] API文档: [通过/失败]
- [ ] 数据库连接: [通过/失败]
- [ ] 其他测试: [通过/失败]

### 发现问题
- [ ] 无
- [ ] 问题1: [描述]
- [ ] 问题2: [描述]

### 修复措施
- [ ] 无
- [ ] 修复1: [描述]
- [ ] 修复2: [描述]

---

## 🎊 总结

**快速启动步骤**:
1. 启动后端服务: `python backend/scripts/start.py`
2. 等待服务启动完成（约10-30秒）
3. 运行测试: `python backend/scripts/test_simple.py`
4. 访问API文档: `http://localhost:8000/docs`

**详细文档**:
- `测试验证计划.md` - 完整的测试计划
- `下一步行动方案.md` - 详细的操作步骤
- `数据库配置说明.md` - 数据库配置说明
- `服务诊断和问题解决指南.md` - 问题解决指南

---

**创建时间**: 2025-01-XX  
**最后更新**: 2025-01-XX  
**状态**: 待执行
