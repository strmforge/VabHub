# 服务启动和测试指南

## 🚀 快速启动服务

### 方式1: 使用简化启动脚本（推荐）

**步骤**:
1. 打开终端
2. 进入项目目录
3. 运行启动脚本

**命令**:
```bash
cd VabHub/backend
python run_server.py
```

### 方式2: 使用批处理文件（Windows）

**步骤**:
1. 双击 `快速启动服务.bat`
2. 或右键选择"以管理员身份运行"

**文件**: `快速启动服务.bat`

### 方式3: 使用uvicorn直接启动

**命令**:
```bash
cd VabHub/backend
python -m uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 方式4: 使用启动脚本（完整检查）

**命令**:
```bash
cd VabHub
python backend/scripts/start.py
```

## 🧪 测试服务

### 测试1: 简单测试

**命令**:
```bash
python backend/scripts/test_simple.py
```

**测试内容**:
- 根端点测试
- API文档测试
- 健康检查测试

### 测试2: 基础功能测试

**命令**:
```bash
python backend/scripts/test_backend_basic.py
```

**测试内容**:
- 健康检查
- API文档
- 数据库连接
- Redis连接
- 统一响应格式

### 测试3: 浏览器测试

**访问地址**:
- API文档: http://localhost:8000/docs
- ReDoc文档: http://localhost:8000/redoc
- 根端点: http://localhost:8000/

## 🔍 检查服务状态

### 检查1: 端口监听

**命令**:
```bash
netstat -ano | findstr ":8000"
```

**预期结果**:
- 应该看到端口8000在LISTENING状态

### 检查2: 进程状态

**命令**:
```bash
Get-Process | Where-Object {$_.ProcessName -like "*python*"}
```

**预期结果**:
- 应该看到Python进程在运行

### 检查3: 服务日志

**命令**:
```bash
Get-Content backend\logs\vabhub_*.log -Tail 50
```

**预期结果**:
- 应该看到服务启动日志
- 应该看到"Application startup complete"消息

## 🐛 故障排除

### 问题1: 端口被占用

**现象**: 启动时提示端口已被占用

**解决方法**:
```bash
# 查找占用端口的进程
netstat -ano | findstr ":8000"

# 终止进程（替换PID为实际进程ID）
taskkill /PID <PID> /F

# 或更改端口
python -m uvicorn main:app --host 0.0.0.0 --port 8001 --reload
```

### 问题2: 数据库连接失败

**现象**: 启动时提示数据库连接失败

**解决方法**:
```bash
# 检查数据库文件是否存在
dir backend\vabhub.db

# 如果不存在，运行初始化脚本
python backend/scripts/init_db.py
```

### 问题3: 依赖缺失

**现象**: 启动时提示模块不存在

**解决方法**:
```bash
# 安装依赖
pip install -r backend/requirements.txt
```

### 问题4: 服务无响应

**现象**: 服务启动但无法响应请求

**解决方法**:
1. 检查防火墙设置
2. 检查HOST配置（应为0.0.0.0）
3. 检查端口配置（应为8000）
4. 查看服务日志查找错误信息

## 📋 启动检查清单

### 启动前检查
- [ ] 数据库文件是否存在（backend/vabhub.db）
- [ ] 依赖包是否安装完整
- [ ] 端口8000是否可用
- [ ] Python版本是否正确（3.8+）

### 启动后检查
- [ ] 服务是否成功启动
- [ ] 端口是否正常监听
- [ ] API文档是否可以访问
- [ ] 健康检查是否通过

## 🎯 推荐流程

### 首次启动
1. 运行数据库初始化: `python backend/scripts/init_db.py`
2. 启动服务: `python backend/run_server.py`
3. 等待服务启动完成（约10-30秒）
4. 访问API文档: http://localhost:8000/docs
5. 运行测试: `python backend/scripts/test_simple.py`

### 日常启动
1. 启动服务: `python backend/run_server.py`
2. 或使用批处理文件: `快速启动服务.bat`
3. 访问API文档验证服务正常

## 📝 注意事项

1. **首次启动**: 需要先运行数据库初始化脚本
2. **端口占用**: 如果端口8000被占用，需要终止占用进程或更改端口
3. **依赖安装**: 确保所有依赖包已安装
4. **日志查看**: 如果启动失败，查看日志文件查找错误信息
5. **防火墙**: 确保防火墙允许端口8000的连接

---

**创建时间**: 2025-01-XX  
**最后更新**: 2025-01-XX  
**状态**: 可用

