# 115ç½‘ç›˜æ–‡ä»¶æœç´¢APIå®˜æ–¹æ–‡æ¡£å¯¹ç…§

## ğŸ“‹ å®˜æ–¹æ–‡æ¡£è§„èŒƒ

### APIç«¯ç‚¹

**è·¯å¾„**: `GET åŸŸå+/open/ufile/search`

**è¯´æ˜**: æ ¹æ®æ–‡ä»¶åæœç´¢æ–‡ä»¶(å¤¹)

### è¯·æ±‚å‚æ•°

#### Headers

| å‚æ•°åç§° | å‚æ•°å€¼ | æ˜¯å¦å¿…é¡» | ç¤ºä¾‹ |
|----------|--------|----------|------|
| Authorization | Bearer access_token | æ˜¯ | Bearer abcdefghijklmnopqrstuvwxyz |

#### Queryå‚æ•°

| å‚æ•°åç§° | æ˜¯å¦å¿…é¡» | ç¤ºä¾‹ | å¤‡æ³¨ |
|----------|----------|------|------|
| search_value | æ˜¯ | | æŸ¥æ‰¾å…³é”®å­— |
| limit | æ˜¯ | | å•é¡µè®°å½•æ•°ï¼Œé»˜è®¤20ï¼Œoffset+limitæœ€å¤§ä¸è¶…è¿‡10000 |
| offset | æ˜¯ | | æ•°æ®æ˜¾ç¤ºåç§»é‡ |
| file_label | å¦ | | æ”¯æŒæ–‡ä»¶æ ‡ç­¾æœç´¢ |
| cid | å¦ | | ç›®æ ‡ç›®å½•cid=-1æ—¶ï¼Œè¡¨ç¤ºä¸è¿”å›åˆ—è¡¨ä»»ä½•å†…å®¹ |
| gte_day | å¦ | 2020-11-19 | æœç´¢ç»“æœåŒ¹é…çš„å¼€å§‹æ—¶é—´ï¼›æ ¼å¼:2020-11-19 |
| lte_day | å¦ | 2020-11-20 | æœç´¢ç»“æœåŒ¹é…çš„ç»“æŸæ—¶é—´ï¼›æ ¼å¼:2020-11-20 |
| fc | å¦ | | åªæ˜¾ç¤ºæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚1åªæ˜¾ç¤ºæ–‡ä»¶å¤¹,2åªæ˜¾ç¤ºæ–‡ä»¶ |
| type | å¦ | | ä¸€çº§ç­›é€‰å¤§åˆ†ç±»,1:æ–‡æ¡£,2:å›¾ç‰‡,3:éŸ³ä¹,4:è§†é¢‘,5:å‹ç¼©åŒ…,6:åº”ç”¨ |
| suffix | å¦ | | ä¸€çº§ç­›é€‰é€‰å…¶ä»–æ—¶å¡«å†™çš„åç¼€å |

### è¿”å›æ•°æ®

| åç§° | ç±»å‹ | å¤‡æ³¨ |
|------|------|------|
| count | number | æœç´¢ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶(å¤¹)æ€»æ•° |
| data | object[] | æ–‡ä»¶åˆ—è¡¨ï¼ˆå¯¹è±¡æ•°ç»„ï¼‰ |
| â”œ file_id | string | æ–‡ä»¶ID |
| â”œ user_id | string | ç”¨æˆ·ID |
| â”œ sha1 | string | æ–‡ä»¶sha1å€¼ |
| â”œ file_name | string | æ–‡ä»¶åç§° |
| â”œ file_size | string | æ–‡ä»¶å¤§å° |
| â”œ user_ptime | string | ä¸Šä¼ æ—¶é—´ |
| â”œ user_utime | string | æ›´æ–°æ—¶é—´ |
| â”œ pick_code | string | æ–‡ä»¶æå–ç  |
| â”œ parent_id | string | çˆ¶ç›®å½•ID |
| â”œ area_id | string | æ–‡ä»¶çš„çŠ¶æ€, aidçš„åˆ«åã€‚1æ­£å¸¸, 7åˆ é™¤(å›æ”¶ç«™), 120å½»åº•åˆ é™¤ |
| â”œ is_private | number | æ–‡ä»¶æ˜¯å¦éšè—ã€‚0æœªéšè—, 1å·²éšè— |
| â”œ file_category | string | 1:æ–‡ä»¶; 0:æ–‡ä»¶å¤¹ |
| â”” ico | string | æ–‡ä»¶åç¼€ |
| limit | number | åˆ†é¡µè·å–å€¼ |
| offset | number | åç§»å€¼ |
| state | boolean | çŠ¶æ€; true:æ­£å¸¸; false:é”™è¯¯ |
| message | string | å¼‚å¸¸ä¿¡æ¯ |
| code | number | å¼‚å¸¸ç  |

## âœ… å½“å‰å®ç°å¯¹ç…§

### å®ç°æ£€æŸ¥

#### 1. APIç«¯ç‚¹ âœ…

- **å®˜æ–¹æ–‡æ¡£**: `GET /open/ufile/search`
- **å½“å‰å®ç°**: `GET /open/ufile/search`
- **çŠ¶æ€**: âœ… æ­£ç¡®

#### 2. è¯·æ±‚å¤´ âœ…

- **å®˜æ–¹æ–‡æ¡£**: `Authorization: Bearer access_token`ï¼ˆå¿…å¡«ï¼‰
- **å½“å‰å®ç°**: ä½¿ç”¨`self.headers`ï¼ŒåŒ…å«`Authorization: Bearer {access_token}`
- **çŠ¶æ€**: âœ… æ­£ç¡®

#### 3. è¯·æ±‚å‚æ•° âœ…

- **å¿…å¡«å‚æ•°**:
  - `search_value`: âœ… å¿…å¡«
  - `limit`: âœ… å¿…å¡«ï¼ˆé»˜è®¤20ï¼‰
  - `offset`: âœ… å¿…å¡«ï¼ˆé»˜è®¤0ï¼‰

- **å¯é€‰å‚æ•°**:
  - `file_label`: âœ… æ”¯æŒ
  - `cid`: âœ… æ”¯æŒ
  - `gte_day`: âœ… æ”¯æŒ
  - `lte_day`: âœ… æ”¯æŒ
  - `fc`: âœ… æ”¯æŒ
  - `type`: âœ… æ”¯æŒï¼ˆfile_typeå‚æ•°ï¼‰
  - `suffix`: âœ… æ”¯æŒ

#### 4. å‚æ•°éªŒè¯ âœ…

- **offset+limité™åˆ¶**: âœ… å·²æ·»åŠ éªŒè¯ï¼ˆä¸è¶…è¿‡10000ï¼‰
- **å‚æ•°æ ¼å¼**: âœ… æ­£ç¡®

#### 5. è¿”å›æ•°æ® âœ…

- **å­—æ®µæ˜ å°„**: âœ… å®Œæ•´
  - `file_id`: âœ… æ–‡ä»¶ID
  - `user_id`: âœ… ç”¨æˆ·IDï¼ˆæ–°å¢ï¼‰
  - `sha1`: âœ… æ–‡ä»¶sha1å€¼
  - `file_name`: âœ… æ–‡ä»¶åç§°
  - `file_size`: âœ… æ–‡ä»¶å¤§å°
  - `user_ptime`: âœ… ä¸Šä¼ æ—¶é—´
  - `user_utime`: âœ… æ›´æ–°æ—¶é—´
  - `pick_code`: âœ… æ–‡ä»¶æå–ç 
  - `parent_id`: âœ… çˆ¶ç›®å½•ID
  - `area_id`: âœ… æ–‡ä»¶çŠ¶æ€
  - `is_private`: âœ… æ–‡ä»¶æ˜¯å¦éšè—ï¼ˆæ–°å¢ï¼‰
  - `file_category`: âœ… æ–‡ä»¶åˆ†ç±»
  - `ico`: âœ… æ–‡ä»¶åç¼€

#### 6. é”™è¯¯å¤„ç† âœ…

- **HTTPé”™è¯¯**: âœ… å·²æ·»åŠ HTTPé”™è¯¯å¤„ç†ï¼ˆ401æœªæˆæƒï¼‰
- **APIé”™è¯¯**: âœ… å·²æ·»åŠ APIé”™è¯¯å¤„ç†
- **æ—¥å¿—è®°å½•**: âœ… å·²æ·»åŠ è¯¦ç»†æ—¥å¿—è®°å½•

## ğŸ“Š å­—æ®µæ˜ å°„å¯¹ç…§

### è¿”å›å­—æ®µæ˜ å°„

| å®˜æ–¹æ–‡æ¡£å­—æ®µ | å½“å‰å®ç°å­—æ®µ | è¯´æ˜ |
|-------------|-------------|------|
| file_id | file_id | æ–‡ä»¶ID |
| user_id | user_id | ç”¨æˆ·ID |
| sha1 | sha1 | æ–‡ä»¶sha1å€¼ |
| file_name | file_name | æ–‡ä»¶åç§° |
| file_size | file_size | æ–‡ä»¶å¤§å° |
| user_ptime | user_ptime | ä¸Šä¼ æ—¶é—´ |
| user_utime | user_utime | æ›´æ–°æ—¶é—´ |
| pick_code | pick_code | æ–‡ä»¶æå–ç  |
| parent_id | parent_id | çˆ¶ç›®å½•ID |
| area_id | area_id | æ–‡ä»¶çŠ¶æ€ï¼ˆ1æ­£å¸¸, 7åˆ é™¤(å›æ”¶ç«™), 120å½»åº•åˆ é™¤ï¼‰ |
| is_private | is_private | æ–‡ä»¶æ˜¯å¦éšè—ï¼ˆ0æœªéšè—, 1å·²éšè—ï¼‰ |
| file_category | file_category | æ–‡ä»¶åˆ†ç±»ï¼ˆ1:æ–‡ä»¶; 0:æ–‡ä»¶å¤¹ï¼‰ |
| ico | ico | æ–‡ä»¶åç¼€ |

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºç¡€æœç´¢

```python
from app.core.cloud_storage.providers.cloud_115_api import Cloud115API

# åˆå§‹åŒ–APIå®¢æˆ·ç«¯
api = Cloud115API(access_token=token_info["access_token"])

# åŸºç¡€æœç´¢
results = await api.search_files(
    search_value="ç”µå½±",
    limit=20,
    offset=0
)

# è¿”å›ç»“æœ
# {
#     "count": 100,
#     "data": [
#         {
#             "file_id": "123456",
#             "user_id": "789",
#             "sha1": "abc123...",
#             "file_name": "ç”µå½±.mkv",
#             "file_size": "1610612736",
#             "user_ptime": "2020-11-19",
#             "user_utime": "2020-11-20",
#             "pick_code": "pick123",
#             "parent_id": "456",
#             "area_id": "1",
#             "is_private": 0,
#             "file_category": "1",
#             "ico": "mkv"
#         }
#     ],
#     "limit": 20,
#     "offset": 0
# }
```

### 2. æŒ‰æ–‡ä»¶ç±»å‹æœç´¢

```python
# æœç´¢è§†é¢‘æ–‡ä»¶
videos = await api.search_files(
    search_value="ç”µå½±",
    file_type=4,  # 4:è§†é¢‘
    limit=50,
    offset=0
)

# æœç´¢å›¾ç‰‡æ–‡ä»¶
images = await api.search_files(
    search_value="ç…§ç‰‡",
    file_type=2,  # 2:å›¾ç‰‡
    limit=50,
    offset=0
)
```

### 3. æŒ‰æ—¶é—´èŒƒå›´æœç´¢

```python
# æœç´¢æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„æ–‡ä»¶
files = await api.search_files(
    search_value="ç”µå½±",
    gte_day="2020-11-19",  # å¼€å§‹æ—¶é—´
    lte_day="2020-11-20",  # ç»“æŸæ—¶é—´
    limit=50,
    offset=0
)
```

### 4. æŒ‰æ–‡ä»¶ç±»åˆ«æœç´¢

```python
# åªæœç´¢æ–‡ä»¶ï¼ˆä¸åŒ…å«æ–‡ä»¶å¤¹ï¼‰
files_only = await api.search_files(
    search_value="ç”µå½±",
    fc=2,  # 2åªæ˜¾ç¤ºæ–‡ä»¶
    limit=50,
    offset=0
)

# åªæœç´¢æ–‡ä»¶å¤¹
folders_only = await api.search_files(
    search_value="ç”µå½±",
    fc=1,  # 1åªæ˜¾ç¤ºæ–‡ä»¶å¤¹
    limit=50,
    offset=0
)
```

### 5. æŒ‰æ–‡ä»¶åç¼€æœç´¢

```python
# æœç´¢ç‰¹å®šåç¼€çš„æ–‡ä»¶
pdf_files = await api.search_files(
    search_value="æ–‡æ¡£",
    suffix="pdf",
    limit=50,
    offset=0
)
```

### 6. æŒ‰æ–‡ä»¶æ ‡ç­¾æœç´¢

```python
# æœç´¢å¸¦ç‰¹å®šæ ‡ç­¾çš„æ–‡ä»¶
tagged_files = await api.search_files(
    search_value="ç”µå½±",
    file_label="é‡è¦",
    limit=50,
    offset=0
)
```

### 7. åœ¨æŒ‡å®šç›®å½•æœç´¢

```python
# åœ¨æŒ‡å®šç›®å½•ä¸­æœç´¢
files = await api.search_files(
    search_value="ç”µå½±",
    cid=123456,  # ç›®æ ‡ç›®å½•ID
    limit=50,
    offset=0
)

# ä¸è¿”å›ä»»ä½•å†…å®¹ï¼ˆcid=-1ï¼‰
no_results = await api.search_files(
    search_value="ç”µå½±",
    cid=-1,  # ä¸è¿”å›åˆ—è¡¨ä»»ä½•å†…å®¹
    limit=50,
    offset=0
)
```

## ğŸ¯ å…³é”®æ”¹è¿›

### 1. å‚æ•°éªŒè¯

1. âœ… **offset+limité™åˆ¶**: å·²æ·»åŠ éªŒè¯ï¼ˆä¸è¶…è¿‡10000ï¼‰
2. âœ… **å¿…å¡«å‚æ•°**: æ˜ç¡®æ ‡æ³¨å¿…å¡«å‚æ•°
3. âœ… **å‚æ•°æ ¼å¼**: éªŒè¯å‚æ•°æ ¼å¼

### 2. è¿”å›æ•°æ®

1. âœ… **å®Œæ•´å­—æ®µæ˜ å°„**: æ˜ å°„äº†æ‰€æœ‰å®˜æ–¹æ–‡æ¡£ä¸­çš„è¿”å›å­—æ®µ
2. âœ… **æ–°å¢å­—æ®µ**: æ·»åŠ äº†`user_id`å’Œ`is_private`å­—æ®µ
3. âœ… **å­—æ®µè¯´æ˜**: æ·»åŠ äº†è¯¦ç»†çš„å­—æ®µè¯´æ˜

### 3. é”™è¯¯å¤„ç†

1. âœ… **HTTPé”™è¯¯**: æ·»åŠ äº†HTTPé”™è¯¯å¤„ç†ï¼ˆ401æœªæˆæƒï¼‰
2. âœ… **APIé”™è¯¯**: æ·»åŠ äº†APIé”™è¯¯å¤„ç†
3. âœ… **æ—¥å¿—è®°å½•**: æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è®°å½•

## ğŸ“ å‚æ•°è¯´æ˜

### å¿…å¡«å‚æ•°

- **search_value**: æŸ¥æ‰¾å…³é”®å­—ï¼ˆå¿…å¡«ï¼‰
- **limit**: å•é¡µè®°å½•æ•°ï¼ˆå¿…å¡«ï¼Œé»˜è®¤20ï¼Œoffset+limitæœ€å¤§ä¸è¶…è¿‡10000ï¼‰
- **offset**: æ•°æ®æ˜¾ç¤ºåç§»é‡ï¼ˆå¿…å¡«ï¼‰

### å¯é€‰å‚æ•°

- **file_label**: æ”¯æŒæ–‡ä»¶æ ‡ç­¾æœç´¢
- **cid**: ç›®æ ‡ç›®å½•IDï¼ˆcid=-1æ—¶ï¼Œè¡¨ç¤ºä¸è¿”å›åˆ—è¡¨ä»»ä½•å†…å®¹ï¼‰
- **gte_day**: æœç´¢ç»“æœåŒ¹é…çš„å¼€å§‹æ—¶é—´ï¼ˆæ ¼å¼:2020-11-19ï¼‰
- **lte_day**: æœç´¢ç»“æœåŒ¹é…çš„ç»“æŸæ—¶é—´ï¼ˆæ ¼å¼:2020-11-20ï¼‰
- **fc**: åªæ˜¾ç¤ºæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼ˆ1åªæ˜¾ç¤ºæ–‡ä»¶å¤¹,2åªæ˜¾ç¤ºæ–‡ä»¶ï¼‰
- **type**: ä¸€çº§ç­›é€‰å¤§åˆ†ç±»ï¼ˆ1:æ–‡æ¡£,2:å›¾ç‰‡,3:éŸ³ä¹,4:è§†é¢‘,5:å‹ç¼©åŒ…,6:åº”ç”¨ï¼‰
- **suffix**: ä¸€çº§ç­›é€‰é€‰å…¶ä»–æ—¶å¡«å†™çš„åç¼€å

### æ–‡ä»¶ç±»å‹è¯´æ˜

- **1**: æ–‡æ¡£
- **2**: å›¾ç‰‡
- **3**: éŸ³ä¹
- **4**: è§†é¢‘
- **5**: å‹ç¼©åŒ…
- **6**: åº”ç”¨

### æ–‡ä»¶çŠ¶æ€è¯´æ˜ï¼ˆarea_idï¼‰

- **1**: æ­£å¸¸
- **7**: åˆ é™¤(å›æ”¶ç«™)
- **120**: å½»åº•åˆ é™¤

### æ–‡ä»¶åˆ†ç±»è¯´æ˜ï¼ˆfcï¼‰

- **1**: åªæ˜¾ç¤ºæ–‡ä»¶å¤¹
- **2**: åªæ˜¾ç¤ºæ–‡ä»¶

### æ–‡ä»¶éšè—çŠ¶æ€è¯´æ˜ï¼ˆis_privateï¼‰

- **0**: æœªéšè—
- **1**: å·²éšè—

## âœ… ç»“è®º

å½“å‰å®ç°**å®Œå…¨ç¬¦åˆ**å®˜æ–¹æ–‡æ¡£è§„èŒƒï¼š

1. âœ… **APIç«¯ç‚¹**: æ­£ç¡®
2. âœ… **è¯·æ±‚å¤´**: æ­£ç¡®
3. âœ… **è¯·æ±‚å‚æ•°**: å®Œæ•´å®ç°æ‰€æœ‰å‚æ•°
4. âœ… **å‚æ•°éªŒè¯**: æ·»åŠ äº†offset+limité™åˆ¶éªŒè¯
5. âœ… **è¿”å›æ•°æ®**: å®Œæ•´æ˜ å°„æ‰€æœ‰è¿”å›å­—æ®µ
6. âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**æ€»ä½“è¯„ä»·**: âœ… **å®ç°å®Œæ•´ï¼Œå®Œå…¨ç¬¦åˆå®˜æ–¹æ–‡æ¡£è§„èŒƒ**

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [115ç½‘ç›˜å®˜æ–¹APIæ–‡æ¡£](https://www.yuque.com/115yun/open/qur839kyx9cgxpxi)
- [æ–‡ä»¶æœç´¢APIå®˜æ–¹æ–‡æ¡£å¯¹ç…§](./115ç½‘ç›˜æ–‡ä»¶æœç´¢APIå®˜æ–¹æ–‡æ¡£å¯¹ç…§.md)
- [æ–‡ä»¶åˆ—è¡¨APIå®˜æ–¹æ–‡æ¡£å¯¹ç…§](./115ç½‘ç›˜æ–‡ä»¶åˆ—è¡¨å’Œæ–‡ä»¶è¯¦æƒ…APIå®˜æ–¹æ–‡æ¡£å¯¹ç…§.md)
- [APIå®¢æˆ·ç«¯ä½¿ç”¨](./115ç½‘ç›˜å®˜æ–¹APIæ–‡æ¡£é›†æˆå®Œæˆæ€»ç»“.md)

