# 115ç½‘ç›˜åŸŸåé…ç½®å¿«é€ŸæŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. DNSè§£æé…ç½®ï¼ˆå¿…é¡»ï¼‰

#### æ­¥éª¤1: æ·»åŠ Aè®°å½•

åœ¨æ‚¨çš„DNSæœåŠ¡å•†ï¼ˆå¦‚é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰æ·»åŠ Aè®°å½•ï¼š

```
ç±»å‹: A
ä¸»æœºè®°å½•: @
è®°å½•å€¼: your-server-public-ip
TTL: 600
```

#### æ­¥éª¤2: éªŒè¯DNSè§£æ

```bash
# ç­‰å¾…å‡ åˆ†é’Ÿåï¼ŒéªŒè¯DNSè§£æ
nslookup vabhub115strm.cn
# æˆ–
dig vabhub115strm.cn
```

### 2. æœåŠ¡å™¨Nginxé…ç½®ï¼ˆå¿…é¡»ï¼‰

#### æ­¥éª¤1: åˆ›å»ºNginxé…ç½®

åˆ›å»ºæ–‡ä»¶ `/etc/nginx/sites-available/vabhub115strm.cn`:

```nginx
server {
    listen 80;
    server_name vabhub115strm.cn www.vabhub115strm.cn;

    location /api/strm/ {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }
}
```

#### æ­¥éª¤2: å¯ç”¨é…ç½®

```bash
sudo ln -s /etc/nginx/sites-available/vabhub115strm.cn /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 3. SSLè¯ä¹¦é…ç½®ï¼ˆæ¨èï¼Œå¦‚æœ115è¦æ±‚HTTPSï¼‰

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d vabhub115strm.cn -d www.vabhub115strm.cn
```

### 4. VabHubç¯å¢ƒå˜é‡é…ç½®

#### æ­¥éª¤1: åˆ›å»º/æ›´æ–° `.env` æ–‡ä»¶

```bash
# STRMé‡å®šå‘æœåŠ¡å™¨é…ç½®
STRM_REDIRECT_URL=https://vabhub115strm.cn
STRM_REDIRECT_BASE_PATH=/api/strm/stream

# JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»æ›´æ”¹ï¼‰
STRM_JWT_SECRET=your-strong-secret-key-here
```

#### æ­¥éª¤2: é‡å¯VabHubæœåŠ¡

```bash
# å¦‚æœä½¿ç”¨systemd
sudo systemctl restart vabhub

# æˆ–å¦‚æœä½¿ç”¨docker
docker-compose restart vabhub
```

### 5. éªŒè¯é…ç½®

#### æµ‹è¯•DNSè§£æ

```bash
ping vabhub115strm.cn
```

#### æµ‹è¯•HTTPè®¿é—®

```bash
curl -I http://vabhub115strm.cn/api/strm/stream/115/test
```

#### æµ‹è¯•HTTPSè®¿é—®ï¼ˆå¦‚æœé…ç½®äº†SSLï¼‰

```bash
curl -I https://vabhub115strm.cn/api/strm/stream/115/test
```

## ğŸ“‹ é…ç½®æ£€æŸ¥æ¸…å•

- [ ] DNS Aè®°å½•å·²æ·»åŠ 
- [ ] DNSè§£æå·²ç”Ÿæ•ˆï¼ˆå¯é€šè¿‡nslookupéªŒè¯ï¼‰
- [ ] Nginxé…ç½®å·²åˆ›å»ºå¹¶å¯ç”¨
- [ ] é˜²ç«å¢™ç«¯å£å·²å¼€æ”¾ï¼ˆ80ã€443ï¼‰
- [ ] SSLè¯ä¹¦å·²ç”³è¯·ï¼ˆå¦‚æœ115è¦æ±‚HTTPSï¼‰
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆSTRM_REDIRECT_URLï¼‰
- [ ] VabHubæœåŠ¡å·²é‡å¯
- [ ] æµ‹è¯•è®¿é—®æˆåŠŸ

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: DNSè§£æå¤±è´¥

**ç—‡çŠ¶**: `nslookup vabhub115strm.cn` è¿”å›æ— ç»“æœ

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥DNS Aè®°å½•æ˜¯å¦æ­£ç¡®é…ç½®
2. ç­‰å¾…DNSä¼ æ’­ï¼ˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰
3. æ£€æŸ¥åŸŸåæ˜¯å¦å·²æ­£ç¡®æ³¨å†Œ

### é—®é¢˜2: æ— æ³•è®¿é—®åŸŸå

**ç—‡çŠ¶**: `curl http://vabhub115strm.cn` è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™æ˜¯å¦å¼€æ”¾80ç«¯å£
2. æ£€æŸ¥äº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™
3. æ£€æŸ¥Nginxé…ç½®æ˜¯å¦æ­£ç¡®
4. æ£€æŸ¥VabHubæœåŠ¡æ˜¯å¦è¿è¡Œåœ¨8000ç«¯å£

### é—®é¢˜3: 502 Bad Gateway

**ç—‡çŠ¶**: è®¿é—®åŸŸåè¿”å›502é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥VabHubæœåŠ¡æ˜¯å¦è¿è¡Œ: `systemctl status vabhub`
2. æ£€æŸ¥VabHubæ—¥å¿—: `journalctl -u vabhub -f`
3. æ£€æŸ¥Nginxåå‘ä»£ç†é…ç½®
4. æ£€æŸ¥VabHubæœåŠ¡ç«¯å£æ˜¯å¦ä¸º8000

### é—®é¢˜4: SSLè¯ä¹¦ç”³è¯·å¤±è´¥

**ç—‡çŠ¶**: `certbot` ç”³è¯·è¯ä¹¦å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿åŸŸåå·²æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨IP
2. ç¡®ä¿80ç«¯å£å·²å¼€æ”¾ï¼ˆLet's Encryptéœ€è¦ï¼‰
3. æ£€æŸ¥Nginxé…ç½®æ˜¯å¦æ­£ç¡®
4. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™

## ğŸ“š è¯¦ç»†æ–‡æ¡£

æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è€ƒï¼š
- [115ç½‘ç›˜å¼€å‘è€…å¹³å°åŸŸåé…ç½®æ–¹æ¡ˆ](./115ç½‘ç›˜å¼€å‘è€…å¹³å°åŸŸåé…ç½®æ–¹æ¡ˆ.md)
- [VabHub STRMæ–‡ä»¶é“¾æ¥æ ¼å¼è®¾è®¡](./VabHub%20STRMæ–‡ä»¶é“¾æ¥æ ¼å¼è®¾è®¡.md)

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. DNSè§£æçŠ¶æ€
2. æœåŠ¡å™¨æ—¥å¿—
3. Nginxé”™è¯¯æ—¥å¿—: `/var/log/nginx/error.log`
4. VabHubæœåŠ¡æ—¥å¿—

