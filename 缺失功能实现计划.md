# 缺失功能实现计划

## 📋 概述

基于MoviePilot功能完整对比报告，需要实现以下缺失功能：

1. **媒体详情页面** - 前端缺失独立页面
2. **人物详情页面** - 前端缺失独立页面
3. **演职员页面** - 前端缺失独立页面（可集成到媒体详情）
4. **Bangumi集成** - 需要完善 API 和前端
5. **应用中心** - 低优先级（暂时跳过）

---

## ✅ 已完成

### 后端API端点 ✅

已添加以下API端点到 `backend/app/api/media.py`：

1. **演职员表API** - `/api/v1/media/credits/{tmdb_id}?type=movie|tv`
   - 返回cast（演员）和crew（工作人员，按部门分组）

2. **人物详情API** - `/api/v1/media/person/{person_id}`
   - 返回人物基本信息、作品列表（电影/电视剧）

3. **类似媒体API** - `/api/v1/media/similar/{tmdb_id}?type=movie|tv`
   - 返回类似媒体列表

4. **推荐媒体API** - `/api/v1/media/recommendations/{tmdb_id}?type=movie|tv`
   - 返回推荐媒体列表

所有API都包含：
- ✅ 缓存支持（24小时）
- ✅ 代理支持（TMDB API）
- ✅ 统一响应格式
- ✅ 错误处理

---

## 🚧 待实现

### 1. 前端API服务更新

**文件**: `frontend/src/services/api.ts`

需要添加：
```typescript
// 媒体API
export const mediaApi = {
  // 获取媒体详情
  getMediaDetails: (tmdbId: number, type: 'movie' | 'tv') => 
    api.get(`/media/details/${tmdbId}`, { params: { type } }),
  
  // 获取演职员表
  getMediaCredits: (tmdbId: number, type: 'movie' | 'tv') => 
    api.get(`/media/credits/${tmdbId}`, { params: { type } }),
  
  // 获取人物详情
  getPersonDetails: (personId: number) => 
    api.get(`/media/person/${personId}`),
  
  // 获取类似媒体
  getSimilarMedia: (tmdbId: number, type: 'movie' | 'tv') => 
    api.get(`/media/similar/${tmdbId}`, { params: { type } }),
  
  // 获取推荐媒体
  getRecommendedMedia: (tmdbId: number, type: 'movie' | 'tv') => 
    api.get(`/media/recommendations/${tmdbId}`, { params: { type } }),
  
  // 获取电视剧季信息
  getTVSeasons: (tmdbId: number) => 
    api.get(`/media/seasons/${tmdbId}`)
}
```

### 2. 媒体详情页面

**文件**: `frontend/src/pages/MediaDetail.vue`

**功能**:
- 媒体基本信息展示（标题、年份、评分、简介等）
- 海报和背景图展示
- 演职员表展示（集成到页面中）
- 类似推荐展示
- 推荐内容展示
- 电视剧季信息展示（如果是电视剧）
- 订阅按钮（如果未订阅）
- 在线播放按钮（如果媒体服务器已配置）

**路由**: `/media/:type/:tmdbId` (例如: `/media/movie/12345`)

### 3. 人物详情页面

**文件**: `frontend/src/pages/PersonDetail.vue`

**功能**:
- 人物基本信息展示（姓名、简介、生日、出生地等）
- 人物照片展示
- 电影作品列表
- 电视剧作品列表
- 点击作品跳转到媒体详情页

**路由**: `/person/:personId` (例如: `/person/12345`)

### 4. 演职员页面（可选）

**选项1**: 集成到媒体详情页面（推荐）
- 在媒体详情页面中添加"演职员"标签页
- 显示演员列表和工作人员列表（按部门分组）

**选项2**: 独立页面
- 创建 `frontend/src/pages/Credits.vue`
- 路由: `/credits/:type/:tmdbId`

**建议**: 采用选项1，集成到媒体详情页面

### 5. Bangumi集成完善

#### 5.1 后端API端点

**文件**: `backend/app/api/media.py` 或新建 `backend/app/api/bangumi.py`

需要添加：
- `/api/v1/bangumi/search?query=xxx&limit=20` - 搜索动漫
- `/api/v1/bangumi/subject/{subject_id}` - 获取动漫详情
- `/api/v1/bangumi/calendar` - 获取每日放送
- `/api/v1/bangumi/popular?limit=20` - 获取热门动漫

**注意**: `BangumiClient` 已存在，只需要添加API端点

#### 5.2 前端展示

**文件**: `frontend/src/pages/Discover.vue`

需要完善：
- Bangumi探索标签页
- Bangumi推荐标签页
- Bangumi每日放送展示
- Bangumi动漫详情展示

### 6. 应用中心（低优先级，暂时跳过）

---

## 📝 实施步骤

### 步骤1: 更新前端API服务 ✅ 准备中

1. 编辑 `frontend/src/services/api.ts`
2. 添加 `mediaApi` 对象
3. 添加 `bangumiApi` 对象（如果需要）

### 步骤2: 创建媒体详情页面

1. 创建 `frontend/src/pages/MediaDetail.vue`
2. 实现媒体信息展示
3. 实现演职员表展示（标签页）
4. 实现类似推荐和推荐内容展示
5. 添加订阅和播放按钮

### 步骤3: 创建人物详情页面

1. 创建 `frontend/src/pages/PersonDetail.vue`
2. 实现人物信息展示
3. 实现作品列表展示
4. 添加跳转到媒体详情页的功能

### 步骤4: 更新路由

1. 编辑 `frontend/src/router/index.ts`
2. 添加媒体详情路由: `/media/:type/:tmdbId`
3. 添加人物详情路由: `/person/:personId`

### 步骤5: 完善Bangumi集成

1. 添加Bangumi API端点（如果需要）
2. 完善 `frontend/src/pages/Discover.vue`
3. 添加Bangumi相关组件

### 步骤6: 更新导航和链接

1. 在搜索结果中添加"查看详情"链接
2. 在推荐列表中添加"查看详情"链接
3. 在演职员表中添加人物链接

---

## 🎯 优先级

1. **高优先级**:
   - ✅ 后端API端点（已完成）
   - ⏳ 前端API服务更新
   - ⏳ 媒体详情页面
   - ⏳ 人物详情页面
   - ⏳ 路由更新

2. **中优先级**:
   - ⏳ Bangumi集成完善

3. **低优先级**:
   - ⏳ 应用中心（暂时跳过）

---

## 📊 预计工作量

- **前端API服务更新**: 30分钟
- **媒体详情页面**: 2-3小时
- **人物详情页面**: 1-2小时
- **路由更新**: 15分钟
- **Bangumi集成完善**: 1-2小时

**总计**: 约5-8小时

---

**最后更新**: 2025-01-XX  
**状态**: 后端API已完成，前端待实现

