# 测试验证启动指南

## 🚀 快速开始

### 1. 环境准备

#### 1.1 检查Python环境
```bash
# 检查Python版本（需要Python 3.8+）
python --version

# 检查pip版本
pip --version
```

#### 1.2 安装依赖
```bash
# 进入后端目录
cd backend

# 安装Python依赖
pip install -r requirements.txt

# 或使用虚拟环境
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或
venv\Scripts\activate  # Windows
pip install -r requirements.txt
```

#### 1.3 配置环境变量
```bash
# 创建.env文件（如果不存在）
# 配置数据库连接
DATABASE_URL=postgresql://user:password@localhost:5432/vabhub

# 配置Redis连接
REDIS_URL=redis://localhost:6379/0

# 配置其他环境变量
# ...
```

#### 1.4 初始化数据库
```bash
# 运行数据库初始化脚本
python backend/scripts/init_db.py
```

### 2. 启动服务

#### 2.1 启动后端服务

**方法1: 使用启动脚本**
```bash
# 使用启动脚本
python backend/scripts/start.py
```

**方法2: 直接使用uvicorn**
```bash
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

**方法3: 使用Python模块**
```bash
cd backend
python -m uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

#### 2.2 验证服务启动

**检查健康检查端点**
```bash
# 使用curl
curl http://localhost:8000/health

# 或使用浏览器访问
# http://localhost:8000/health
```

**检查API文档**
```bash
# 使用浏览器访问
# http://localhost:8000/docs
```

### 3. 运行测试

#### 3.1 运行后端基础功能测试
```bash
# 运行基础功能测试脚本
python backend/scripts/test_backend_basic.py
```

#### 3.2 运行115网盘功能测试
```bash
# 运行115网盘测试脚本
python backend/scripts/test_115_qrcode.py
python backend/scripts/test_115_file_operations.py
python backend/scripts/test_115_token_persist.py
```

#### 3.3 运行API统一响应格式测试
```bash
# 运行API测试脚本
python backend/scripts/test_unified_response_api.py
```

### 4. 启动前端服务

#### 4.1 安装前端依赖
```bash
cd frontend
npm install
```

#### 4.2 启动前端服务
```bash
# 开发模式
npm run dev

# 生产模式
npm run build
npm run preview
```

#### 4.3 访问前端应用
```bash
# 浏览器访问
# http://localhost:5173
```

---

## 📋 测试 checklist

### 后端测试

- [ ] 数据库连接正常
- [ ] Redis连接正常
- [ ] 后端服务启动成功
- [ ] 健康检查通过
- [ ] API文档可访问
- [ ] 统一响应格式正确
- [ ] 错误处理正常

### 前端测试

- [ ] 前端服务启动成功
- [ ] 页面加载正常
- [ ] API调用正常
- [ ] 错误处理正常
- [ ] 用户体验良好

### 115网盘测试

- [ ] 115网盘配置创建成功
- [ ] 二维码生成成功
- [ ] 登录功能正常
- [ ] 文件列表正常
- [ ] 文件操作正常

---

## 🐛 常见问题

### 问题1: 数据库连接失败

**错误信息**:
```
sqlalchemy.exc.OperationalError: could not connect to server
```

**解决方法**:
1. 检查数据库服务是否启动
2. 检查数据库连接配置是否正确
3. 检查数据库用户权限
4. 检查防火墙设置

### 问题2: Redis连接失败

**错误信息**:
```
redis.exceptions.ConnectionError: Error connecting to Redis
```

**解决方法**:
1. 检查Redis服务是否启动
2. 检查Redis连接配置是否正确
3. 检查Redis密码设置
4. 检查防火墙设置

### 问题3: 端口被占用

**错误信息**:
```
OSError: [Errno 48] Address already in use
```

**解决方法**:
1. 检查端口是否被其他进程占用
2. 更改端口配置
3. 终止占用端口的进程

### 问题4: 模块导入错误

**错误信息**:
```
ModuleNotFoundError: No module named 'xxx'
```

**解决方法**:
1. 检查依赖是否安装完整
2. 重新安装依赖: `pip install -r requirements.txt`
3. 检查Python路径配置

---

## 📊 测试结果

### 测试统计

- **测试用例总数**: [数量]
- **通过测试**: [数量]
- **失败测试**: [数量]
- **通过率**: [百分比]

### 测试报告

测试完成后，请记录测试结果到 `测试验证计划.md` 文件中。

---

## 🎯 下一步

测试验证完成后，根据测试结果：
1. 修复发现的问题
2. 优化性能
3. 完善文档
4. 准备生产环境

---

**创建时间**: 2025-01-XX  
**状态**: 待执行

