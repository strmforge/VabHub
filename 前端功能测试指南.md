# 前端功能测试指南

## 测试图片懒加载

### 测试步骤

1. **打开浏览器开发者工具**：
   - 按 `F12` 或右键 -> 检查
   - 切换到 `Network` 标签
   - 筛选 `Img` 类型

2. **测试搜索页面**：
   - 访问搜索页面：`http://localhost:5173/search`
   - 执行搜索，查看结果列表
   - 观察网络请求：
     - 初始只加载可见区域的图片
     - 滚动时，新进入视口的图片才开始加载
     - 图片加载时显示进度指示器

3. **测试订阅页面**：
   - 访问订阅页面：`http://localhost:5173/subscriptions`
   - 观察订阅卡片：
     - 海报图片懒加载
     - 背景图片懒加载
     - 加载时显示骨架屏

4. **验证要点**：
   - ✅ 初始加载时，只请求可见图片
   - ✅ 滚动时，新图片按需加载
   - ✅ 加载中显示占位符
   - ✅ 加载失败显示错误图标

---

## 测试搜索防抖

### 测试步骤

1. **打开浏览器开发者工具**：
   - 按 `F12` 或右键 -> 检查
   - 切换到 `Network` 标签
   - 筛选 `XHR` 或 `Fetch` 类型

2. **测试搜索建议**：
   - 访问搜索页面：`http://localhost:5173/search`
   - 在搜索框中快速输入多个字符（如：`movie`）
   - 观察网络请求：
     - 应该只有最后一次输入后300ms才发送请求
     - 之前的输入不会触发请求

3. **测试搜索功能**：
   - 输入搜索关键词
   - 点击搜索按钮或按回车
   - 验证搜索结果正常显示

4. **验证要点**：
   - ✅ 快速输入时，请求数量减少
   - ✅ 输入框显示立即更新（用户体验）
   - ✅ 搜索建议请求有300ms延迟
   - ✅ 不会因为快速输入导致过多请求

---

## 测试WebSocket实时推送

### 测试步骤

1. **打开浏览器控制台**：
   - 按 `F12` 或右键 -> 检查
   - 切换到 `Console` 标签

2. **连接WebSocket**：
   ```javascript
   const ws = new WebSocket('ws://localhost:8092/api/ws/ws')
   
   ws.onopen = () => {
     console.log('WebSocket连接已建立')
     // 订阅系统资源主题
     ws.send(JSON.stringify({
       type: 'subscribe',
       topics: ['system', 'api_performance', 'dashboard']
     }))
   }
   
   ws.onmessage = (event) => {
     const data = JSON.parse(event.data)
     console.log('收到消息:', data)
     
     if (data.type === 'system_update') {
       console.log('系统资源:', data.data)
     } else if (data.type === 'api_performance_update') {
       console.log('API性能:', data.data)
     } else if (data.type === 'dashboard_update') {
       console.log('仪表盘:', data.data)
     }
   }
   
   ws.onerror = (error) => {
     console.error('WebSocket错误:', error)
   }
   
   ws.onclose = () => {
     console.log('WebSocket连接已关闭')
   }
   ```

3. **验证推送频率**：
   - 系统资源：每2秒推送一次
   - API性能：每10秒推送一次
   - 仪表盘：每5秒推送一次

4. **验证要点**：
   - ✅ WebSocket连接成功
   - ✅ 订阅主题成功
   - ✅ 收到实时推送数据
   - ✅ 数据格式正确
   - ✅ 推送频率符合预期

---

## 测试检查清单

### 图片懒加载
- [ ] 搜索页面图片懒加载正常
- [ ] 订阅页面图片懒加载正常
- [ ] 加载占位符显示正常
- [ ] 错误占位符显示正常
- [ ] 网络请求按需加载

### 搜索防抖
- [ ] 搜索建议防抖正常（300ms）
- [ ] 输入框显示立即更新
- [ ] 请求数量减少
- [ ] 搜索功能正常

### WebSocket实时推送
- [ ] WebSocket连接成功
- [ ] 订阅主题成功
- [ ] 系统资源推送正常（每2秒）
- [ ] API性能推送正常（每10秒）
- [ ] 仪表盘推送正常（每5秒）

---

## 常见问题

### 图片懒加载不工作
- 检查浏览器是否支持 `loading="lazy"` 属性
- 检查图片URL是否有效
- 检查网络请求是否正常

### 搜索防抖不工作
- 检查浏览器控制台是否有错误
- 检查网络请求是否正常
- 验证防抖函数是否正确实现

### WebSocket连接失败
- 检查后端服务是否运行
- 检查WebSocket URL是否正确
- 检查防火墙设置
- 检查浏览器控制台错误信息

---

**提示**: 如果遇到问题，请查看浏览器控制台和网络请求，以获取更多信息。
